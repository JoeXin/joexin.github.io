class MusicPlayer{constructor(){this.init()}init(){document.documentElement.style.setProperty("--vh",window.innerHeight+"px"),this.getCustomPlayList(),this.addEventListeners()}getCustomPlayList(){this.changeMusicBg(!1)}addEventListeners(){document.addEventListener("keydown",this.handleKeydown.bind(this));let e=document.querySelector(".aplayer-list"),t=document.querySelector(".aplayer-lrc");t&&!t.dataset.clickBound&&(t.addEventListener("click",()=>{e.classList.toggle("aplayer-list-hide")}),t.dataset.clickBound=!0)}changeMusicBg(e=!0){var t=document.getElementById("Music-bg"),a=document.getElementsByClassName("Music-loading")[0];e?this.updateBackgroundImage(t):this.setLoadingScreen(a,t)}updateBackgroundImage(e){let t=document.querySelector("#Music-page .aplayer-pic"),a=new Image;a.src=this.extractValue(t.style.backgroundImage),a.onload=()=>{e.style.backgroundImage=t.style.backgroundImage,e.className="show"}}setLoadingScreen(e,t){let a=setInterval(()=>{this.addEventListeners(),document.querySelector("#Music-page .aplayer-pic")&&(e.style.display="none",clearInterval(a),this.addEventListenerChangeMusicBg(),t.style.display="block")},100)}extractValue(e){return(e=/url\("([^"]+)"\)/.exec(e))?e[1]:""}addEventListenerChangeMusicBg(){var e=document.querySelector("#Music-page meting-js").aplayer;e.on("loadeddata",()=>this.changeMusicBg(!0)),e.on("timeupdate",this.lrcUpdate.bind(this))}lrcUpdate(){var e=document.querySelector(".aplayer-lrc-contents"),t=e.querySelector("p.aplayer-lrc-current");t&&(t=Array.from(e.children).indexOf(t),e.style.transform=`translateY(${80*-t}px)`)}handleKeydown(e){let t=document.querySelector("meting-js").aplayer,a={Space:()=>t.toggle(),ArrowRight:()=>t.skipForward(),ArrowLeft:()=>t.skipBack(),ArrowUp:()=>{t.volume<1&&t.volume(t.volume+.1)},ArrowDown:()=>{0<t.volume&&t.volume(t.volume-.1)}};a[e.code]&&(e.preventDefault(),a[e.code]())}destroy(){document.removeEventListener("keydown",this.handleKeydown)}}function initializeMusicPlayer(){var e=window.scoMusic;e&&e.destroy(),window.scoMusic=new MusicPlayer}