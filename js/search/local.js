window.addEventListener("load",()=>{let s=[],e=document.getElementById("search-mask"),t=document.querySelector("#local-search .search-dialog"),n=(window.openSearch=()=>{utils.animateIn(e,"to_show 0.5s"),t.style.display="flex",setTimeout(()=>{document.querySelector("#local-search .search-box-input").focus()},100),document.addEventListener("keydown",function e(t){"Escape"===t.code&&(a(),document.removeEventListener("keydown",e))}),n(),window.addEventListener("resize",n)},()=>{window.innerWidth<768&&t.style.setProperty("--search-height",window.innerHeight+"px")}),a=()=>{utils.animateOut(t,"search_close .5s"),utils.animateOut(e,"to_hide 0.5s"),window.removeEventListener("resize",n)},c,r=(0<(c=document.querySelectorAll("#local-search .tag-list")).length&&c.forEach(e=>e.addEventListener("click",e=>a())),document.addEventListener("keydown",function(e){e.ctrlKey&&"k"===e.key&&(e.preventDefault(),openSearch())}),e.addEventListener("click",a),utils.addEventListenerPjax(document.querySelector("#local-search .search-close-button"),"click",a),()=>{utils.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",openSearch),GLOBAL_CONFIG.right_menu&&document.getElementById("menu-search").addEventListener("click",function(){rm.hideRightMenu(),openSearch();var e=document.getElementsByClassName("search-box-input")[0],t=document.createEvent("HTMLEvents");t.initEvent("input",!0,!0),e.value=selectTextNow,e.dispatchEvent(t)})}),i=(r(),""),o=0,d=10,m=[];function l(){let l=document.getElementById("search-results");document.getElementById("search-input").addEventListener("input",function(e){if((l.innerHTML="")!==(i=this.value.trim())){u(m=(e=>{let t=new RegExp(e.split("").join(".*"),"i");return s.filter(e=>t.test(e.title)||t.test(e.content))})(i),o);var t=m.length,n=Math.ceil(t/d),a=((t=document.getElementById("search-pagination")).innerHTML="",document.createElement("ul"));a.className="pagination-list";for(let t=0;t<n;t++){let e=document.createElement("li");e.className="pagination-item",e.textContent=t+1,t===o&&e.classList.add("select"),e.addEventListener("click",function(){o=t,u(m,t),document.querySelectorAll(".pagination-item").forEach(function(e){e.classList.remove("select")}),e.classList.add("select")}),a.appendChild(e)}t.appendChild(a)}else t=document.getElementById("search-results"),c=document.getElementById("search-pagination"),r=document.getElementById("search-tips"),t.innerHTML="",c.innerHTML="",r.innerHTML="";var c,r})}function u(e,t){let c=document.getElementById("search-results");c.innerHTML="";var n=document.getElementById("search-tips");n.innerHTML="";var a=(t=t*d)+d;e.length?(e.slice(t,a).forEach(function(e){var t,n=document.createElement("li"),a=(n.className="search-result-item",document.createElement("a"));a.className="search-result-title",a.href=e.link,a.innerHTML=(e=e.title,t=i,t=new RegExp(`(${t.split(" ").join("|")})`,"gi"),e.replace(t,"<em>$1</em>")),n.appendChild(a),c.appendChild(n)}),(t=document.createElement("span")).className="search-result-count",t.innerHTML=GLOBAL_CONFIG.lang.search.count.replace(/\$\{count}/,e.length),n.appendChild(t)):((a=document.createElement("span")).className="search-result-empty",a.textContent=GLOBAL_CONFIG.lang.search.empty.replace(/\$\{query}/,i),c.appendChild(a))}fetch(GLOBAL_CONFIG.localsearch.path).then(e=>e.text()).then(e=>{var t=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("entry");for(let e=0;e<t.length;e++){var n=(c=t[e]).getElementsByTagName("title")[0].textContent,a=c.getElementsByTagName("url")[0].textContent,c=c.getElementsByTagName("content")[0].textContent;s.push({title:n,link:a,content:c})}}).catch(e=>console.error("Error loading search data:",e)),l(),window.addEventListener("DOMContentLoaded",e=>{l()}),window.addEventListener("pjax:complete",()=>{r()})});